---
layout: post
title: "node.js 맛보기 < 1편 > - 개념과 설치 방법"
date: 2019-05-01
excerpt: "제로초님 인프런 강의와 다양한 구글링 정보 총 집합"
category: Node
tags: [node, javascript, server]
comments: true
---

<h1><center>node.js 개념과 설치 방법</center></h1>

<br>
<center>node 포스팅은 제로초님의 인프런 강의와 구글링을 통해 작성하였습니다. node.js는 10.15.3 버전 기반입니다.</center>
<br>

>나는 1학년 때 부터 서버를 조금씩 공부했다. node를 사용해 미니프로젝트를 하나 했었는데 영 보잘것 없는 사이트를 하나 만들었던 기억이 있다. 현재는 사회복무요원으로 근무하고 있어 시간이 널널하지만 대학을 다닐 때는 개인적인 공부를 할 시간이 많지 않아 수박 겉핥기 수준으로 공부를 했었기 때문에 완성도는 눈 뜨고 볼 수준이 아니었다. ~~물론 맨날 술 쳐마신 것을 생각하면 다 핑계다;;~~ 2학년이 되어서 서버를 제대로 구축하고 싶어 Django에도 손을 대보고 심지어 Django와 ELK를 다루는 외주까지 해보았지만 여전히 겉에서 맴도는 수준에서 그쳤다. 이유는 파이썬이 머릿속에 잘 들어오지 않아서였다. 그래서 다시 시작한게 node.js다.

<br>

앞으로 node 시리즈 포스팅은 제로초님의 강의가 기반이 된다. node를 공부하기 위한 기본 개념부터 정리하고 node의 기능을 정리할 것이다. 그 이후에 Express와 간단한 예제들을 정리해서 올릴 예정이다.

이번 포스팅에서는 간단하게 node.js가 어떤 맛인지 살펴보고 끝내도록 하자.

<br>

## node.js란 무엇인가?

> node.js는 서버인가? js 라이브러리인가?

`node`는 자바스크립트 런타임이다. `node` 자체가 서버라고 오해하시는 분들이 많은데 쉽게 일종의 가상머신이라고 생각하면 편하다. 제로초님은 '`node`는 웹 브라우저 안에서만 작동하던 js를 웹 브라우저 바깥 환경에서 돌릴 수 있는 프로그램이다' 라고 쉽게 생각하라고 하셨다.

<br>

## Ryan Dahl의 설명

`Ryan Dahl`(이하 라이언)님은 `Node.js`를 만드신 분이다. ~~혼자 만든 것인지 팀이 만든 것인지는 잘 모르겠지만..~~ 이 분의 [1차 발표 영상](http://www.youtube.com/watch?v=M-sc73Y-zQA)을 보면 어떤 생각으로 `node`를 만든 것인지 알 수 있다.

* `node.js`는 구글 V8 자바스크립트 가상머신(VM)의 바인딩 세트이다.
    * 즉 `chrome DevTools`와 같은 엔진이다.
* `NGINX`보다 빠르다.
    * `NGINX`는 C로 구현되어있으며 이벤트루프에 완전 최적화되어 있다. `node`는 그런 `NGINX`보다도 빠르다.
* 우리는 평상시에 I/O를 완전히 잘못 쓰고 있다. 예를 들어 
    ```javascript
    result = query('select * from T');
    ```
    이렇게 작성하면 쿼리함수가 작업하는 동안 소프트웨어는 멈춰있게 된다. DISK나 네트워크에서 저런 식으로 수 백만 사이클을 돌리는 작업을 하면 `블럭킹` 함수가 된다. 캐시 메모리에서 수 백만 사이클을 돌리는 작업은 속도가 굉장히 빨라 `블럭킹`이 되지 않을 수도 있다.
    >CPU에 접근하는 건 책상으로 가서 서랍을 열어서 서류 몇 장 꺼
    내는 거고, RAM은 복도를 지나가서 다른 방의 누구가랑 얘기 좀 하다 뭔가 들고 오는 거고, 디스크에 접근하는 건 비행기를 타고 도쿄에 가서 서류를 받아오는 것과 같습니다. - 라이언
    * 그래서 우리는 `이벤트 루프`를 사용해 `논블럭킹` 코드를 작성해야 한다.
        ```javascript
        query('select...', (result)=>{});
        ```
    * 사람들은 `callback` 구문을 보면 '복잡해서 안돼요. 스파게티코드네요.'라는 식으로 거부한다. 그치만 `논블럭킹`을 위해서는 어쩔 수 없다.

사실 더 많은 이야기들이 있다. [영상](http://www.youtube.com/watch?v=M-sc73Y-zQA)에서 꼭 보는 것을 추천한다. 이 분의 생각을 이해해야 `node`를 확실하게 활용할 수 있다. ~~난 포기..~~

<br>

## 이벤트 기반, 싱글 쓰레드, 논블로킹 I/O

`node.js`는 `이벤트 기반`, `싱글 쓰레드`, `논블로킹 I/O`이라는 세 가지 주요 개념을 가지고 있다. 이번 포스팅에서는 깊게 다루지 않고 간단히 알아보기만 할 것이다. 라이언의 설명처럼 `node`는 `이벤트 루프`를 사용해 `논블로킹 I/O`를 지원한다. 즉, `이벤트 기반`이라는 뜻이다.

> 사람들이 node.js는 왜 빠르다고 하는거지? 싱글 쓰레드인데 그럼 속도가 엄청 느리지 않을까? 

javascript는 `싱글 쓰레드`이다. 하나의 팔로 작업을 한다고 생각하면 편하다. 그래서 작업을 한 번에 하나씩 밖에 처리를 못한다. 그치만 속도는 정말 빠른 고성능 서버 클라이언트이다. 이게 어떻게 가능한 일일까? 물론 깊게 들어가면 정말 팔 하나로 작업을 하는 친구는 아니다. 이 이야기는 깊게 하면 할 수록 아주 어려운 내용이므로 일단은 간단하게 설명하고 넘어가겠다.

>서버는 요청을 보내면 응답을 받는다. 즉, 서버는 요청을 받으면 응답을 보낸다. 요청을 보내는 쪽을 클라이언트 응답을 보내는 쪽을 서버라고 한다. - 제로초

서버는 항상 클라이언트의 요청이 들어오기 전까지 기다리고 있다. 클라이언트가 서버에 요청을 보내면 `호출 스택`(`callstack`)에 쌓이게 되는데 `LIFO`(Last in First Out)형식으로 처리가 된다. `호출 스택`에 들어오면 차례로 하나씩 마지막 요청 순으로 처리가 된다. 그렇지만 예를 들어 스택에 처리시간이 오래 걸리는 DISK나 네트워크의 쿼리작업이 들어오게 되면 이 작업이 끝날 때 까지 다른 작업을 할 수 없는 상태가 된다. 그래서 우리는 `이벤트 루프`를 사용하여 이를 `태스크 큐`로 처리한다. 시간이 오래 걸릴 것 같은 작업들은 `태스크 큐`에 던져버리고 작업이 다 끝나면 결과만 받아본다고 생각하면 편하다. 이를 `이벤트 루프`가 다리 역할을 하며 일을 처리한다. 이러한 메커니즘으로 돌아가는 노드를 `이벤트 기반`이라고 부른다.

<br>

## node.js 설치

이 부분은 내가 따로 설명하는 것을 보는 것 보다 공식 사이트를 참고하는 것이 제일 정확하다. 윈도우, 리눅스 둘 다 전부 [`여기`](https://nodejs.org/ko/download/) 사이트에 들어가면 쉽게 다운로드 할 수 있다. 그치만 GUI가 없는 환경에서는 [`여기`](https://nodejs.org/ko/download/package-manager/)를 참고하면 된다.